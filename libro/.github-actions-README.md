# üöÄ GitHub Actions per Libro SLIPS

## Workflow Disponibili

### 1. Compilazione Automatica (`compile-libro.yml`)

**Trigger**: 
- Push su `main` con modifiche in `libro/`
- Pull Request con modifiche in `libro/`
- Manuale (workflow_dispatch)

**Azioni**:
1. Compila libro LaTeX ‚Üí PDF
2. Upload PDF come artifact (disponibile 90 giorni)
3. Se push su main: crea release automatica con tag `libro-YYYY-MM-DD`

**Uso**:
- Ogni commit in `libro/` su main ‚Üí nuovo PDF
- Download da Actions artifacts o Releases

### 2. Release Manuale (`libro-release.yml`)

**Trigger**: Solo manuale (workflow_dispatch)

**Input**:
- `version`: Es. "1.0", "2.0-draft", "1.5-beta"
- `prerelease`: true/false

**Azioni**:
1. Compila con 3 passate (bibliografia + indice completi)
2. Rinomina PDF: `SLIPS-Libro-v1.0.pdf`
3. Crea release GitHub con tag `libro-v1.0`
4. Upload PDF nel release

**Uso**:
```
1. Vai su GitHub ‚Üí Actions ‚Üí "Release Libro (Manuale)"
2. Click "Run workflow"
3. Inserisci versione (es. "1.0")
4. Run
5. PDF disponibile in Releases
```

### 3. Deploy su Pages (Opzionale) (`libro-pages.yml`)

**Trigger**: Push su `main` in `libro/`

**Azioni**:
1. Compila libro LaTeX
2. Deploy PDF su GitHub Pages
3. Disponibile su: `https://gpicchiarelli.github.io/SLIPS/libro.pdf`

**Nota**: Richiede abilitare GitHub Pages nel repository.

---

## üîß Setup Iniziale

### Nessun Setup Richiesto!

I workflow usano:
- **xu-cheng/latex-action**: Container Docker con TeX Live completo
- **actions/upload-artifact**: Built-in GitHub
- **softprops/action-gh-release**: Per release automatiche

Tutto funziona out-of-the-box! ‚úÖ

### Permessi GitHub

Per release automatiche, verifica che GitHub Actions abbia permessi:

```
Settings ‚Üí Actions ‚Üí General ‚Üí Workflow permissions
‚Üí Seleziona "Read and write permissions"
```

---

## üì• Scaricare PDF Compilato

### Metodo 1: Artifacts (build recenti)

```
1. GitHub ‚Üí Actions ‚Üí "Compila Libro LaTeX"
2. Click su run specifico
3. Scroll down ‚Üí "Artifacts"
4. Download "libro-slips"
```

**Retention**: 90 giorni

### Metodo 2: Releases (milestone)

```
1. GitHub ‚Üí Releases
2. Trova release "Libro SLIPS - YYYY-MM-DD"
3. Download "SLIPS-Libro-vX.Y.pdf"
```

**Retention**: Permanente

### Metodo 3: GitHub Pages (se abilitato)

```
https://gpicchiarelli.github.io/SLIPS/libro.pdf
```

**Aggiornamento**: Ad ogni push su main

---

## üéØ Workflow Consigliati

### Per Sviluppo Continuo

Usa **compile-libro.yml**:
- Compila automaticamente ad ogni push
- PDF in artifacts per review
- Release datate per tracking

### Per Release Ufficiali

Usa **libro-release.yml**:
- Controllo manuale versione
- Tag semantico (v1.0, v2.0)
- Release note curate
- PDF nominato con versione

### Per Distribuzione Web

Usa **libro-pages.yml**:
- PDF sempre disponibile via URL
- Aggiornamento automatico
- No limite retention

---

## üîç Troubleshooting

### Compilazione Fallisce

**Errore comune**: LaTeX syntax error

1. Check logs in GitHub Actions
2. Cerca linea con errore: `! LaTeX Error:`
3. Correggi in file locale
4. Test locale: `cd libro && make`
5. Push fix

### Artifact Non Visibile

- Artifacts sono visibili solo a collaboratori repo
- Per pubblico: usa Releases (pubbliche)

### Release Non Creata

- Verifica permessi workflow (Settings ‚Üí Actions)
- Check che push sia su branch `main`
- Verifica che file `libro/**` sia modificato

---

## üìä Esempio Output CI

```
‚úÖ Checkout repository
‚úÖ Compile LaTeX document
   - Pass 1: pdflatex main.tex
   - BibTeX: biber main
   - MakeIndex: makeindex main
   - Pass 2: pdflatex main.tex
   - Pass 3: pdflatex main.tex
‚úÖ Upload PDF as artifact
‚úÖ Create Release
   - Tag: libro-2025-10-15
   - Asset: main.pdf (2.1 MB)
```

**Tempo**: ~5 minuti per compilazione completa

---

## üéì Best Practices

### Quando Usare Release Manuale

- ‚úÖ Versioni milestone (1.0, 2.0)
- ‚úÖ Edizioni complete
- ‚úÖ Dopo major updates

### Quando Usare Release Automatica

- ‚úÖ Continuous deployment
- ‚úÖ Nightly builds
- ‚úÖ Per review interna

### Gestione Versioni

```
libro-v1.0          ‚Üí Prima edizione completa
libro-v1.1          ‚Üí Minor updates
libro-v2.0          ‚Üí Seconda edizione (tutti capitoli)
libro-v2.0-draft    ‚Üí Pre-release per review
```

---

## üîó Link Utili

- **xu-cheng/latex-action**: https://github.com/xu-cheng/latex-action
- **GitHub Actions Docs**: https://docs.github.com/actions
- **GitHub Releases**: https://docs.github.com/repositories/releasing-projects-on-github

---

## üí° Tips

### Compilazione Locale Prima di Push

```bash
cd libro
make clean
make
# Se compila localmente, compiler√† anche in CI
```

### Cache LaTeX Packages (Futuro)

Per velocizzare CI, si pu√≤ cachare TeX Live:

```yaml
- name: Cache TeX Live
  uses: actions/cache@v3
  with:
    path: /usr/share/texlive
    key: texlive-${{ hashFiles('libro/**/*.tex') }}
```

### Notifica su Telegram/Slack

Aggiungi step per notificare compilazione:

```yaml
- name: Notify on success
  if: success()
  run: |
    curl -X POST \
      -H 'Content-Type: application/json' \
      -d '{"text":"‚úÖ Libro SLIPS compilato!"}' \
      ${{ secrets.SLACK_WEBHOOK_URL }}
```

---

**I workflow sono pronti! Basta commitare e pushare.** üöÄ

