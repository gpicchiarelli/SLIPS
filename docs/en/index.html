<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SLIPS - Swift Language Implementation of Production Systems. Faithful translation of CLIPS 6.4.2 to Swift 6.2">
    <meta name="keywords" content="SLIPS, CLIPS, Swift, Expert Systems, Rule Engine, RETE Algorithm, Pattern Matching">
    <meta name="author" content="SLIPS Contributors">
    <meta property="og:title" content="SLIPS - English Documentation">
    <meta property="og:description" content="Expert system shell - Faithful translation of CLIPS to Swift">
    <meta property="og:type" content="website">
    <title>SLIPS - English Documentation</title>
    <link rel="icon" type="image/svg+xml" href="../assets/favicon.svg">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <span class="logo">‚ö°</span>
                <a href="../" style="text-decoration: none; color: inherit;">
                    <span class="brand-name">SLIPS</span>
                </a>
            </div>
            <div class="nav-links">
                <div class="lang-switch">
                    <button data-lang="en" class="active">EN</button>
                    <button data-lang="it" onclick="window.location.href='../it/'">IT</button>
                </div>
                <a href="examples.html">Examples</a>
                <a href="api.html">API</a>
                <a href="https://github.com/gpicchiarelli/SLIPS" target="_blank" class="github-link">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                    </svg>
                </a>
            </div>
        </div>
    </nav>

    <div class="doc-container">
        <div class="doc-header">
            <h1 class="doc-title">SLIPS Documentation</h1>
            <p class="doc-subtitle">Swift Language Implementation of Production Systems</p>
        </div>

        <div class="doc-nav">
            <h2>üìö Table of Contents</h2>
            <ul>
                <li><a href="#intro">Introduction</a></li>
                <li><a href="#quickstart">Quick Start</a></li>
                <li><a href="#architecture">Architecture</a></li>
                <li><a href="#api">API Reference</a></li>
                <li><a href="#examples">Examples</a></li>
                <li><a href="#rete">RETE Algorithm</a></li>
                <li><a href="#contributing">Contributing</a></li>
            </ul>
        </div>

        <div class="doc-content">
            <section id="intro">
                <h2>üéØ Introduction</h2>
                <p>
                    <strong>SLIPS</strong> (Swift Language Implementation of Production Systems) is a faithful semantic 
                    translation of CLIPS 6.4.2 to Swift 6.2. The project maintains the original philosophy, algorithms, 
                    and architecture of CLIPS while adapting them to Swift's modern type safety features.
                </p>

                <div class="alert alert-info">
                    <strong>üìå Note:</strong> This is not a simple wrapper or binding, but a complete file-by-file 
                    translation of CLIPS C source code into idiomatic Swift.
                </div>

                <h3>Why SLIPS?</h3>
                <ul>
                    <li><strong>Type Safety:</strong> Swift 6.2's robust type system</li>
                    <li><strong>Memory Safety:</strong> Automatic memory management without malloc/free</li>
                    <li><strong>Modern Syntax:</strong> Clean, idiomatic Swift code</li>
                    <li><strong>Faithful Translation:</strong> Preserves RETE, salience, agenda strategies</li>
                    <li><strong>Well Documented:</strong> Each Swift file maps to C source</li>
                </ul>
                
                <h3>Current Status</h3>
                <ul>
                    <li>‚úÖ <strong>Unary exists:</strong> Parsing/IR and LHS evaluation without introducing bindings</li>
                    <li>‚úÖ <strong>Optimized not delta:</strong> Incremental propagation for negated CEs</li>
                    <li>‚úÖ <strong>Incremental join:</strong> Beta engine with prefiltering and hash buckets</li>
                    <li>üöß <strong>Complete RETE:</strong> Explicit alpha/beta/join nodes in development</li>
                </ul>

                <h3>What is CLIPS?</h3>
                <p>
                    CLIPS (C Language Integrated Production System) is an expert system shell developed by NASA. 
                    It uses a rule-based engine built on the RETE algorithm for efficient pattern matching and 
                    supports procedural, object-oriented, and rule-driven programming paradigms.
                </p>
            </section>

            <section id="quickstart">
                <h2>üöÄ Quick Start</h2>
                
                <h3>Installation</h3>
                <p>Add SLIPS to your <code>Package.swift</code>:</p>
                <pre><code>dependencies: [
    .package(url: "https://github.com/gpicchiarelli/SLIPS.git", from: "0.1.0")
]</code></pre>

                <h3>First Program</h3>
                <pre><code>import SLIPS

// Create an environment
let env = CLIPS.createEnvironment()

// Define a template
CLIPS.eval(expr: """
(deftemplate person
    (slot name)
    (slot age (type INTEGER)))
""")

// Define a rule
CLIPS.eval(expr: """
(defrule greet-adult
    (person (name ?n) (age ?a&:(>= ?a 18)))
    =>
    (printout t "Hello " ?n ", you are an adult!" crlf))
""")

// Assert facts
CLIPS.eval(expr: "(assert (person (name \"John\") (age 25)))")
CLIPS.eval(expr: "(assert (person (name \"Jane\") (age 16)))")

// Run rules
let fired = CLIPS.run(limit: nil)
print("Rules fired: \(fired)")</code></pre>

                <h3>CLI Execution</h3>
                <pre><code>swift run slips-cli
SLIPS> (facts)
SLIPS> (rules)
SLIPS> (run)</code></pre>
            </section>

            <section id="architecture">
                <h2>üèóÔ∏è Architecture</h2>
                
                <h3>Core Components</h3>
                <ul>
                    <li><strong>Environment:</strong> Execution context (facts, rules, agenda)</li>
                    <li><strong>Parser:</strong> Lexical and syntactic analysis of CLIPS expressions</li>
                    <li><strong>Evaluator:</strong> Expression evaluation and function calls</li>
                    <li><strong>RETE Network:</strong> Efficient pattern matching network</li>
                    <li><strong>Agenda:</strong> Activation management with strategies (depth, breadth, LEX, MEA)</li>
                    <li><strong>Router System:</strong> Flexible I/O with customizable callbacks</li>
                </ul>

                <h3>C ‚Üí Swift Mapping</h3>
                <table style="width: 100%; border-collapse: collapse; margin: 1rem 0;">
                    <tr style="background: var(--bg-darker); border-bottom: 2px solid var(--border);">
                        <th style="padding: 0.75rem; text-align: left;">C (CLIPS)</th>
                        <th style="padding: 0.75rem; text-align: left;">Swift (SLIPS)</th>
                    </tr>
                    <tr style="border-bottom: 1px solid var(--border);">
                        <td style="padding: 0.75rem;"><code>struct</code></td>
                        <td style="padding: 0.75rem;"><code>struct</code></td>
                    </tr>
                    <tr style="border-bottom: 1px solid var(--border);">
                        <td style="padding: 0.75rem;"><code>union</code> + type tag</td>
                        <td style="padding: 0.75rem;"><code>enum</code> with associated values</td>
                    </tr>
                    <tr style="border-bottom: 1px solid var(--border);">
                        <td style="padding: 0.75rem;"><code>#define</code> macros</td>
                        <td style="padding: 0.75rem;"><code>static let</code> or computed properties</td>
                    </tr>
                    <tr style="border-bottom: 1px solid var(--border);">
                        <td style="padding: 0.75rem;"><code>malloc/free</code></td>
                        <td style="padding: 0.75rem;"><code>Array</code>, <code>Dictionary</code>, ARC</td>
                    </tr>
                    <tr style="border-bottom: 1px solid var(--border);">
                        <td style="padding: 0.75rem;">Pointers</td>
                        <td style="padding: 0.75rem;">Reference types, <code>Unsafe*</code> when needed</td>
                    </tr>
                </table>

                <h3>File Structure</h3>
                <pre><code>Sources/SLIPS/
‚îú‚îÄ‚îÄ Core/
‚îÇ   ‚îú‚îÄ‚îÄ envrnmnt.swift      (environment.c)
‚îÇ   ‚îú‚îÄ‚îÄ evaluator.swift     (evaluatn.c)
‚îÇ   ‚îú‚îÄ‚îÄ expressn.swift      (expressn.c)
‚îÇ   ‚îú‚îÄ‚îÄ scanner.swift       (scanner.c)
‚îÇ   ‚îú‚îÄ‚îÄ router.swift        (router.c)
‚îÇ   ‚îî‚îÄ‚îÄ functions.swift     (built-in functions)
‚îú‚îÄ‚îÄ Rete/
‚îÇ   ‚îú‚îÄ‚îÄ AlphaNetwork.swift  (alpha memory)
‚îÇ   ‚îú‚îÄ‚îÄ BetaEngine.swift    (beta network)
‚îÇ   ‚îî‚îÄ‚îÄ Nodes.swift         (RETE nodes)
‚îú‚îÄ‚îÄ Agenda/
‚îÇ   ‚îî‚îÄ‚îÄ Agenda.swift        (agenda.c)
‚îî‚îÄ‚îÄ CLIPS.swift             (public facade)</code></pre>
            </section>

            <section id="api">
                <h2>üìñ API Reference</h2>
                
                <h3>CLIPS (Main Facade)</h3>
                <pre><code>// Create environment
static func createEnvironment() -> Environment

// Load file
static func load(_ path: String) -> Bool

// Reset environment
static func reset()

// Run rules
static func run(limit: Int?) -> Int

// Assert facts
static func assert(fact: String) -> Int

// Retract facts
static func retract(id: Int) -> Bool

// Evaluate expressions
static func eval(expr: String) -> Value

// Interactive command loop
static func commandLoop()</code></pre>

                <h3>Environment</h3>
                <pre><code>struct Environment {
    var facts: [Int: FactRec]           // Fact base
    var rules: [Rule]                    // Defined rules
    var templates: [String: Template]    // Deftemplate templates
    var agendaQueue: AgendaQueue         // Activation queue
    var rete: ReteNetwork                // RETE network
    var watchFacts: Bool                 // Watch facts
    var watchRules: Bool                 // Watch rules
    var experimentalJoinCheck: Bool      // Experimental beta engine
}</code></pre>

                <h3>Value (Data Types)</h3>
                <pre><code>enum Value: Codable, Equatable {
    case none
    case int(Int64)
    case float(Double)
    case string(String)
    case symbol(String)
    case boolean(Bool)
    case multifield([Value])
    case factAddress(Int)
    case instanceAddress(String)
    case externalAddress(String)
}</code></pre>
            </section>

            <section id="examples">
                <h2>üí° Examples</h2>
                
                <h3>Expert System: Car Diagnosis</h3>
                <pre><code>(deftemplate problem
    (slot type)
    (slot description))

(deftemplate symptom
    (slot name)
    (slot severity (type INTEGER)))

(defrule diagnose-battery
    (symptom (name "engine-wont-start"))
    (symptom (name "dim-lights"))
    =>
    (assert (problem 
        (type "dead-battery")
        (description "Battery needs recharge or replacement")))
    (printout t "Diagnosis: Dead battery" crlf))

(defrule diagnose-alternator
    (problem (type "dead-battery"))
    (symptom (name "battery-drains-quickly"))
    =>
    (printout t "Possible alternator failure" crlf))</code></pre>

                <h3>Advanced Pattern Matching</h3>
                <pre><code>(deftemplate order
    (slot id)
    (slot customer)
    (slot amount (type FLOAT))
    (slot urgent (type SYMBOL)))

(defrule high-priority-order
    (order (id ?id) 
           (customer ?c) 
           (amount ?amt&:(> ?amt 1000.0))
           (urgent YES))
    =>
    (printout t "HIGH PRIORITY: Order " ?id 
                " from " ?c " for $" ?amt crlf))

(defrule loyal-customer-discount
    (order (id ?id) (customer ?c) (amount ?amt))
    (premium-customer (name ?c) (years ?y&:(>= ?y 5)))
    =>
    (bind ?discount (* ?amt 0.15))
    (printout t "15% discount for " ?c ": $" ?discount crlf))</code></pre>

                <h3>Negation and NOT Patterns</h3>
                <pre><code>(defrule customer-without-orders
    (customer (id ?id) (name ?n))
    (not (order (customer-id ?id)))
    =>
    (printout t "Customer " ?n " has never ordered" crlf))

(defrule out-of-stock
    (product (code ?c) (name ?n))
    (not (inventory (product ?c) (quantity ?q&:(> ?q 0))))
    =>
    (printout t "ALERT: " ?n " is out of stock!" crlf))</code></pre>
            </section>

            <section id="rete">
                <h2>‚ö° RETE Algorithm</h2>
                
                <h3>What is RETE?</h3>
                <p>
                    RETE is a pattern matching algorithm developed by Charles Forgy in 1979. 
                    It optimizes rule matching by avoiding rechecking unchanged conditions in each cycle.
                </p>

                <h3>RETE Components in SLIPS</h3>
                <ul>
                    <li><strong>Alpha Network:</strong> Template index, filters facts by constants</li>
                    <li><strong>Beta Network:</strong> Incremental joins between patterns, maintains partial tokens</li>
                    <li><strong>Beta Memory:</strong> Cache of intermediate matches for efficiency</li>
                    <li><strong>Join Nodes:</strong> Conjunction nodes between patterns (WIP)</li>
                </ul>

                <div class="alert alert-warning">
                    <strong>‚ö†Ô∏è Implementation Status:</strong> RETE is in active development:
                    <ul style="margin-top: 0.5rem;">
                        <li>‚úÖ Alpha indexing by template</li>
                        <li>‚úÖ Beta engine for positive patterns</li>
                        <li>‚úÖ Incremental updates on assert/retract</li>
                        <li>‚úÖ Negated patterns with incremental delta propagation</li>
                        <li>‚úÖ Unary exists (without bindings)</li>
                        <li>‚úÖ Predicate tests in joins with hash buckets</li>
                        <li>üöß Explicit RETE nodes (alpha/beta/join nodes) - in development</li>
                    </ul>
                </div>

                <h3>Experimental Flag</h3>
                <pre><code>// Enable comparison between classic backtracking and beta engine
CLIPS.eval(expr: "(set-join-check on)")

// Check status
let status = CLIPS.eval(expr: "(get-join-check)")
// Returns: boolean(true)</code></pre>

                <p>
                    When <code>join-check</code> is active, SLIPS runs <strong>both</strong> algorithms 
                    and logs any divergences to STDERR. This helps validate the incremental implementation.
                </p>
            </section>

            <section id="contributing">
                <h2>ü§ù Contributing</h2>
                
                <h3>Guidelines</h3>
                <p>See <code>AGENTS.md</code> in the repository root for complete rules. In summary:</p>
                
                <ul>
                    <li>Faithful semantic translation, don't simplify algorithms</li>
                    <li>File-by-file mapping: each <code>.c/.h</code> ‚Üí corresponding <code>.swift</code></li>
                    <li>Avoid force unwrapping, prefer <code>guard let</code> and pattern matching</li>
                    <li>Comment in Italian, cite original C function names</li>
                    <li>Add tests for each translated module</li>
                </ul>

                <h3>Development Setup</h3>
                <pre><code>git clone https://github.com/gpicchiarelli/SLIPS.git
cd SLIPS
swift build
swift test</code></pre>

                <h3>Running Tests</h3>
                <pre><code># All tests
swift test

# Specific test
swift test --filter ReteJoinCheckTests

# With verbose output
swift test --verbose</code></pre>

                <h3>Modules to Translate</h3>
                <p>Reference to original CLIPS sources:</p>
                <pre><code>clips_core_source_642/core/
‚îú‚îÄ‚îÄ agenda.c/h          ‚Üí Agenda/Agenda.swift ‚úÖ
‚îú‚îÄ‚îÄ drive.c/h           ‚Üí Rete/BetaEngine.swift üöß
‚îú‚îÄ‚îÄ pattern.c/h         ‚Üí (to be translated)
‚îú‚îÄ‚îÄ reteutil.c/h        ‚Üí (to be translated)
‚îú‚îÄ‚îÄ network.c/h         ‚Üí (to be translated)
‚îî‚îÄ‚îÄ ...</code></pre>

                <h3>Roadmap</h3>
                <p>See <code>docs/ROADMAP.md</code> for detailed phase planning:</p>
                <ul>
                    <li><strong>Phase 1 (current):</strong> Core + Parser + Basic RETE</li>
                    <li><strong>Phase 2:</strong> Complete RETE + NCC</li>
                    <li><strong>Phase 3:</strong> COOL (Object-Oriented)</li>
                    <li><strong>Phase 4:</strong> Optimizations + Advanced Features</li>
                </ul>

                <div class="alert alert-success">
                    <strong>üíö Contributions Welcome!</strong> 
                    Pull requests are always appreciated. For major changes, please open an issue first to discuss what you'd like to change.
                </div>
            </section>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <p>SLIPS - Semantic translation of CLIPS 6.4.2 to Swift 6.2</p>
            <p class="footer-links">
                <a href="examples.html">Examples</a> ¬∑ 
                <a href="api.html">API</a> ¬∑ 
                <a href="https://github.com/gpicchiarelli/SLIPS" target="_blank">GitHub</a> ¬∑ 
                <a href="../it/">Italiano</a>
            </p>
        </div>
    </footer>

    <script src="../js/main.js"></script>
</body>
</html>

